//= require jquery
//= require jquery-ui
//= require jquery_ujs
//= require i18n
//= require i18n/translations

$(document).ready(function()
{

	// CUSTOMS THE SEARCH BAR
	customForm("search_bar", "");

	// CLOSES FLASH MESSAGES THROUGH THE X BUTTON
	$("#close_flash").click(function()
	{
	  $("#flash").hide();
	})
});

// CUSTOMS ALL THE FIELDS OF THE GIVEN FORM
function customForm(formId, translationPath)
{
  $("#"+formId+" input").each(function()
  {
  	if (!$(this).hasClass("hidden") && $(this).attr("type") != "hidden") {
  	  customInputField($(this).attr("id"), I18n.t(translationPath+$(this).attr("id")), formId, $(this).attr("type"));
  	  submitFormOnReturn($(this).attr("id"), formId, translationPath);
  	}
  });
}

// STYLES THE GIVEN FIELD AND ENABLES SUBMIT BY HITTING THE RETURN KEY
function customInputField(inputFieldId, inputFieldDefaultValue, formId, inputFieldType)
{
	if (inputFieldType == "password")
	{
		styleInputPasswordField(inputFieldId, inputFieldDefaultValue);
	}
	else
	{
		styleInputField(inputFieldId, inputFieldDefaultValue);
	}	
}

// STYLES THE GIVEN INPUT FIELD
function styleInputField(inputFieldId, inputFieldDefaultValue)
{
	$("#"+inputFieldId).ready(function()
	{
		if ($("#"+inputFieldId).val() == inputFieldDefaultValue)
	    {
	      $("#"+inputFieldId).css("color", "#7c7777");
	      $("#"+inputFieldId).css("font-style", "italic");
	    } 
	    else {
	      $("#"+inputFieldId).css("color", "#444");
	      $("#"+inputFieldId).css("font-style", "normal");
	    }	    	    
	});
	
	$("#"+inputFieldId).focus(function()
	{
		if($("#"+inputFieldId).val() == inputFieldDefaultValue)
		{
			$("#"+inputFieldId).css("color", "#acacb3");	
		}
	});

	$("#"+inputFieldId).keydown(function()
	{
		if($("#"+inputFieldId).val() == inputFieldDefaultValue)
		{
			$("#"+inputFieldId).val("");			
			$("#"+inputFieldId).css("font-style", "normal");
			$("#"+inputFieldId).css("color", "#444");	
		}
	});

	$("#"+inputFieldId).blur(function()
	{
		if($("#"+inputFieldId).val() == "" || $("#"+inputFieldId).val() == inputFieldDefaultValue)
		{
			$("#"+inputFieldId).css("font-style", "italic");
			$("#"+inputFieldId).css("color", "#7c7777");
			if($("#"+inputFieldId).val() == "")
			{
				$("#"+inputFieldId).val(inputFieldDefaultValue); 
			}
		}
	});
}

// STYLES THE GIVEN PASSWORD FIELD
function styleInputPasswordField(inputFieldId, inputFieldDefaultValue)
{
  $("#"+inputFieldId).after("<input class='field' id='"+inputFieldId+"_placeholder' type='text' value='"+inputFieldDefaultValue+"' />");
	$("#"+inputFieldId+"_placeholder").css("color", "#7c7777");
  $("#"+inputFieldId+"_placeholder").css("font-style", "italic");
	$("#"+inputFieldId+"_placeholder").show();	
	$("#"+inputFieldId).hide();
	
	$("#"+inputFieldId+"_placeholder").focus(function()
	{
		$("#"+inputFieldId+"_placeholder").css("color", "#acacb3");	
	});
	
	$("#"+inputFieldId+"_placeholder").keydown(function()
	{
		$("#"+inputFieldId+"_placeholder").hide();
		$("#"+inputFieldId).val("");
		$("#"+inputFieldId).show();
		$("#"+inputFieldId).focus();
	});
	
	$("#"+inputFieldId+"_placeholder").blur(function()
	{
		if ($("#"+inputFieldId+"_placeholder").val() == "" || $("#"+inputFieldId+"_placeholder").val() == inputFieldDefaultValue)
		{			
			$("#"+inputFieldId+"_placeholder").css("color", "#7c7777");
		}		
	});
	
	$("#"+inputFieldId).blur(function()
	{
		if($("#"+inputFieldId).val() == "" || $("#"+inputFieldId).val() == inputFieldDefaultValue)
		{			
			$("#"+inputFieldId+"_placeholder").show();
			$("#"+inputFieldId).hide();
			$("#"+inputFieldId+"_placeholder").css("color", "#7c7777");
		}		
	});
}

// SUBMITS THE GIVEN FORM BY HITTING THE RETURN KEY
function submitFormOnReturn(inputFieldId, formId, translationPath)
{
  $("#"+inputFieldId).keydown(function(e)
  {
    if (e.keyCode == 13)
    {
      emptyDefaultValuesForm(formId, translationPath);
      $("#"+formId).submit();
    }
  });
}

// SUBMITS THE GIVEN FORM THROUGH THE GIVEN EXTERNAL BUTTON
function submitForm(formId, buttonId, translationPath) {
  
  $("#"+buttonId).click(function()
  {
    emptyDefaultValuesForm(formId, translationPath);
    $("#"+formId).submit();
  })
}

// GIVEN A FORM, EMPTIES FIELDS THAT HAVE DEFAULT VALUES
function emptyDefaultValuesForm(formId, translationPath)
{
  $("#"+formId+" input").each(function()
  {
  	if (!$(this).hasClass("hidden") && $(this).attr("type") != "hidden") {
  	  emptyDefaultValueField($(this).attr("id"), I18n.t(translationPath+$(this).attr("id")));
  	}
  });
}

// EMPTIES THE GIVEN FIELD IF IT HAS THE DEFAULT VALUE
function emptyDefaultValueField(inputFieldId, inputFieldDefaultValue) {
  if ($("#"+inputFieldId).val() == inputFieldDefaultValue) {
    $("#"+inputFieldId).val("");
  }
}