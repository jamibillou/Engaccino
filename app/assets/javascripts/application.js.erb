//= require jquery
//= require jquery-ui
//= require jquery_ujs
//= require i18n
//= require i18n/translations

$(document).ready(function()
{

	// CUSTOMS THE SEARCH BAR
	customForm("search_bar","");

	// CLOSES FLASH MESSAGES THROUGH THE X BUTTON
	$("#close_flash").click(function()
	{
	  $("#flash").hide();
	})
});

// CUSTOMS ALL THE FIELDS OF THE GIVEN FORM
function customForm(formId,translationPath)
{
  $("#"+formId+" input").each(function()
  {
  	if (!$(this).hasClass("hidden") && $(this).attr("type") != "hidden") {
  	  customInputField($(this).attr("id"),I18n.t(translationPath+$(this).attr("id")),formId,$(this).attr("type"));
  	}
  });
}

// STYLES THE GIVEN FIELD AND ENABLES SUBMIT BY HITTING THE RETURN KEY
function customInputField(inputFieldId,inputFieldDefaultValue,formId,inputFieldType)
{
	if(inputFieldType == "password")
	{
		styleInputPasswordField(inputFieldId,inputFieldDefaultValue);
	}
	else
	{
		styleInputField(inputFieldId,inputFieldDefaultValue);
	}	
	submitFormOnReturn(inputFieldId,formId,inputFieldDefaultValue);
}

// STYLES THE GIVEN INPUT FIELD
function styleInputField(inputFieldId,inputFieldDefaultValue)
{
	$("#"+inputFieldId).ready(function()
	{
		if ($("#"+inputFieldId).attr("value") == inputFieldDefaultValue)
	    {
	      $("#"+inputFieldId).css("color","#7c7777");
	      $("#"+inputFieldId).css("font-style","italic");
	    } 
	    else {
	      $("#"+inputFieldId).css("color","#444");
	      $("#"+inputFieldId).css("font-style","normal");
	    }	    	    
	});
	
	$("#"+inputFieldId).click(function()
	{
		if($("#"+inputFieldId).attr("value") == inputFieldDefaultValue)
		{
			$("#"+inputFieldId).css("color","#acacb3");	
		}
	});

	$("#"+inputFieldId).keydown(function()
	{
		if($("#"+inputFieldId).attr("value") == inputFieldDefaultValue)
		{
			$("#"+inputFieldId).attr("value","");			
			$("#"+inputFieldId).css("font-style","normal");
			$("#"+inputFieldId).css("color","#444");	
		}
	});

	$("#"+inputFieldId).focusout(function()
	{
		if($("#"+inputFieldId).attr("value") == "" || $("#"+inputFieldId).attr("value") == inputFieldDefaultValue)
		{
			$("#"+inputFieldId).css("font-style","italic");
			$("#"+inputFieldId).css("color","#7c7777");
			if($("#"+inputFieldId).attr("value") == "")
			{
				$("#"+inputFieldId).attr("value",inputFieldDefaultValue); 
			}
		}
	});
}

//STYLES THE PASSWORD FIELDS
function styleInputPasswordField(inputFieldId,inputFieldDefaultValue)
{
    $("#"+inputFieldId).after("<input class='field' id='"+inputFieldId+"_Placeholder' type='text' value='"+inputFieldDefaultValue+"'/>");
	$("#"+inputFieldId+"_Placeholder").css("color","#7c7777");
    $("#"+inputFieldId+"_Placeholder").css("font-style","italic");
	$("#"+inputFieldId+"_Placeholder").show();	
	$("#"+inputFieldId).hide();
	
	$("#"+inputFieldId+"_Placeholder").focus(function()
	{
		$("#"+inputFieldId+"_Placeholder").hide();
		$("#"+inputFieldId).attr("value","");
		$("#"+inputFieldId).show();
		$("#"+inputFieldId).focus();
	});
	
	$("#"+inputFieldId).blur(function()
	{
		if($("#"+inputFieldId).val() == "")
		{			
			$("#"+inputFieldId+"_Placeholder").show();
			$("#"+inputFieldId).hide();
		}		
	});
}

// SUBMITS THE GIVEN FORM BY HITTING THE RETURN KEY
function submitFormOnReturn(inputFieldId,formId,inputFieldDefaultValue)
{
  $("#"+inputFieldId).keydown(function(e)
  {
    if (e.keyCode == 13)
    {
      emptyDefaultValuesForm(formId,inputFieldDefaultValue);
      $("#"+formId).submit();
    }
  });
}

// SUBMITS THE GIVEN FORM THROUGH THE GIVEN EXTERNAL BUTTON
function submitForm(formId,buttonId,inputFieldDefaultValue) {
  
  $("#"+buttonId).click(function()
  {
    emptyDefaultValuesForm(formId,inputFieldDefaultValue);
    $("#"+formId).submit();
  })
}

// GIVEN A FORM, EMPTIES FIELDS THAT HAVE DEFAULT VALUES
function emptyDefaultValuesForm(formId,inputFieldDefaultValue)
{
  $("#"+formId+" input").each(function()
  {
  	if (!$(this).hasClass("hidden") && $(this).attr("type") != "hidden") {
  	  emptyDefaultValueField($(this).attr("id"),inputFieldDefaultValue);
  	}
  });
}

// EMPTIES THE GIVEN FIELD IF IT HAS THE DEFAULT VALUE
function emptyDefaultValueField(inputFieldId,inputFieldDefaultValue) {
  if ($("#"+inputFieldId).attr("value") == inputFieldDefaultValue) {
    $("#"+inputFieldId).attr("value", "");
  }
}