//= require jquery
//= require jquery_ujs
//= require i18n
//= require i18n/translations

$(document).ready(function()
{
	
	// CUSTOMS FORMS
	customForm("search_bar","");
	
	// CLOSES THE FLASH MESSAGES
	$("#close_flash").click(function()
	{
	  $("#flash").hide();
	})
});

// CUSTOMS ALL THE FIELDS OF THE FORM PASSED AS PARAMETER
function customForm(formId,view)
{
  $("#"+formId+" input").each(function()
  {
  	if (!$(this).hasClass("hidden") && $(this).attr("type") != "hidden") {
  	  customInputField($(this).attr("id"),$(this).attr("value"),formId,view);
  	}
  });
}

// STYLES THE GIVEN FIELD AND ENABLES SUBMIT BY HITTING THE RETURN KEY
function customInputField(inputFieldId,inputFieldValue,formId,view)
{
	styleInputField(inputFieldId,inputFieldValue);
	submitFormOnReturn(inputFieldId,formId,view)
}

// STYLES THE INPUT FIELD PASSED AS PARAMETER
function styleInputField(inputFieldId,inputFieldValue)
{
	$("#"+inputFieldId).click(function()
	{
		if($("#"+inputFieldId).attr("value") == inputFieldValue)
		{
			$("#"+inputFieldId).css("color","#acacb3");	
		}
	});
	
	$("#"+inputFieldId).keydown(function()
	{
		if($("#"+inputFieldId).attr("value") == inputFieldValue)
		{
			$("#"+inputFieldId).attr("value","");
			$("#"+inputFieldId).css("font-style","normal");
			$("#"+inputFieldId).css("color","#444");	
		}
	});
	
	$("#"+inputFieldId).focusout(function()
	{
		if($("#"+inputFieldId).attr("value") == "" || $("#"+inputFieldId).attr("value") == inputFieldValue)
		{
			$("#"+inputFieldId).css("font-style","italic");
			$("#"+inputFieldId).css("color","#7c7777");
			if($("#"+inputFieldId).attr("value") == "")
			{
				$("#"+inputFieldId).attr("value",inputFieldValue); 
			}
		}
	});
}

// SUBMITS FORM BY HITTING THE RETURN KEY
function submitFormOnReturn(inputFieldId,formId,view)
{
  $("#"+inputFieldId).keydown(function(e)
  {
    if (e.keyCode == 13)
    {
      emptyDefaultValuesFromForm(formId,view);
      $("#"+formId).submit();
    }
  });
}

// SUBMITS FORM THROUGH AN EXTERNAL BUTTON
function submitForm(formId,buttonId,view) {
  
  $("#"+buttonId).click(function()
  {
    emptyDefaultValuesFromForm(formId,view);
    $("#"+formId).submit();
  })
}

// EMPTIES FIELDS THAT STILL HAVE THE DEFAULT VALUE
function emptyDefaultValuesFromForm(formId,view)
{
  $("#"+formId+" input").each(function()
  {
  	if (!$(this).hasClass("hidden") && $(this).attr("type") != "hidden") {
  	  emptyFieldsWithDefaultValue($(this).attr("id"),view);
  	}
  });
}

function emptyFieldsWithDefaultValue(inputFieldId,view) {
  if ($("#"+inputFieldId).attr("value") == I18n.t(view+"."+inputFieldId)) {
    $("#"+inputFieldId).attr("value", "");
  }
}