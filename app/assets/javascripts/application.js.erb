//= require jquery
//= require jquery_ujs
//= require i18n
//= require i18n/translations

$(document).ready(function()
{
	
	// CUSTOMS THE SEARCH BAR
	customForm("search_bar","");
	
	// CLOSES FLASH MESSAGES THROUGH THE X BUTTON
	$("#close_flash").click(function()
	{
	  $("#flash").hide();
	})
});

// CUSTOMS ALL THE FIELDS OF THE GIVEN FORM
function customForm(formId,translationPath)
{
  $("#"+formId+" input").each(function()
  {
  	if (!$(this).hasClass("hidden") && $(this).attr("type") != "hidden") {
  	  customInputField($(this).attr("id"),$(this).attr("value"),formId,translationPath);
  	}
  });
}

// STYLES THE GIVEN FIELD AND ENABLES SUBMIT BY HITTING THE RETURN KEY
function customInputField(inputFieldId,inputFieldValue,formId,translationPath)
{
	styleInputField(inputFieldId,inputFieldValue);
	submitFormOnReturn(inputFieldId,formId,translationPath)
}

// STYLES THE GIVEN INPUT FIELD
function styleInputField(inputFieldId,inputFieldValue)
{
	$("#"+inputFieldId).click(function()
	{
		if($("#"+inputFieldId).attr("value") == inputFieldValue)
		{
			$("#"+inputFieldId).css("color","#acacb3");	
		}
	});
	
	$("#"+inputFieldId).keydown(function()
	{
		if($("#"+inputFieldId).attr("value") == inputFieldValue)
		{
			$("#"+inputFieldId).attr("value","");
			$("#"+inputFieldId).css("font-style","normal");
			$("#"+inputFieldId).css("color","#444");	
		}
	});
	
	$("#"+inputFieldId).focusout(function()
	{
		if($("#"+inputFieldId).attr("value") == "" || $("#"+inputFieldId).attr("value") == inputFieldValue)
		{
			$("#"+inputFieldId).css("font-style","italic");
			$("#"+inputFieldId).css("color","#7c7777");
			if($("#"+inputFieldId).attr("value") == "")
			{
				$("#"+inputFieldId).attr("value",inputFieldValue); 
			}
		}
	});
}

// SUBMITS THE GIVEN FORM BY HITTING THE RETURN KEY
function submitFormOnReturn(inputFieldId,formId,translationPath)
{
  $("#"+inputFieldId).keydown(function(e)
  {
    if (e.keyCode == 13)
    {
      emptyDefaultValuesForm(formId,translationPath);
      $("#"+formId).submit();
    }
  });
}

// SUBMITS THE GIVEN FORM THROUGH THE GIVEN EXTERNAL BUTTON
function submitForm(formId,buttonId,translationPath) {
  
  $("#"+buttonId).click(function()
  {
    emptyDefaultValuesForm(formId,translationPath);
    $("#"+formId).submit();
  })
}

// GIVEN A FORM, EMPTIES FIELDS THAT HAVE DEFAULT VALUES
function emptyDefaultValuesForm(formId,translationPath)
{
  $("#"+formId+" input").each(function()
  {
  	if (!$(this).hasClass("hidden") && $(this).attr("type") != "hidden") {
  	  emptyDefaultValueField($(this).attr("id"),translationPath);
  	}
  });
}

// EMPTIES THE GIVEN FIELD IF IT HAS THE DEFAULT VALUE
function emptyDefaultValueField(inputFieldId,translationPath) {
  if ($("#"+inputFieldId).attr("value") == I18n.t(translationPath+inputFieldId)) {
    $("#"+inputFieldId).attr("value", "");
  }
}